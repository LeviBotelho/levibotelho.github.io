<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>SEO for Single Page ASP.NET Apps with Spoon &#8211; </title>
<meta name="description" content="">
<meta name="keywords" content="asp.net, angular.js, seo, google, spoon, open source">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="SEO for Single Page ASP.NET Apps with Spoon">
<meta property="og:description" content="">
<meta property="og:url" content="/open%20source/2014/03/24/seo-for-single-page-asp-net-apps-with-spoon.html">
<meta property="og:site_name" content="">
<meta property="og:image" content="/images/">





<link rel="canonical" href="/open%20source/2014/03/24/seo-for-single-page-asp-net-apps-with-spoon.html">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />






<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  

<header id="masthead" class="blog-background overlay align-center align-middle animated from-bottom"  style="background-image: url(/images/)" itemscope itemtype="http://schema.org/Organization">


    <div class="inner">
        <div class="container">
            <a class="brand" href="/" role="banner" itemprop="url">

                

            <h1 class="blog-title light" itemprop="name">
                
            </h1>
                
            </a>
        </div>
    </div>
    
    
    <div class="decor-wrapper">
        <svg id="header-decor" class="decor bottom" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">
            <path d="M0 99.9 L50 49.9 L100 99.9 L0 99.9" fill="rgba(255,255,255, 1)"></path>

            <path d="M48 52 L50 49 L52 52 L48 52" fill="rgba(255,255,255, 1)"></path>

        </svg>
    </div>
    
</header>
<div id="main" class="content" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
    <div class="container">
        <div class="row">
            <article class="post col-md-8 col-md-offset-2 hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
            
            
            
                
            
             
             
                    <header class="post-header entry-header">
                        
                        <h1 class="post-title text-center hyper lighter bordered-bottom entry-title" itemprop="headline">SEO for Single Page ASP.NET Apps with Spoon</h1>
                        
                        <div class="post-info text-center small">
                            <span class="entry-date date published updated"><time datetime="2014-03-24T00:00:00+01:00" class="post-time" itemprop="datePublished">24 Mar 2014</time><span>
                            in <span class="post-tags"><a href="/categories/index.html#open source" data-toggle="tooltip" title="Other posts from the Open source category" rel="tag">Open source</a></span>
                        </div>
                    </header>
                    <div class="post-body bordered-bottom" itemprop="description">
                        
                        <p>Search engine optimisation is one of the most important aspects of any public web application. However single page application developers face a significant challenge in exposing their content to search engines and web crawlers.</p>

<p>The problem is that the concept of a web page is not necessarily the same for a web server as it is for a user. While the user of an SPA could navigate through an entire site and be convinced that it was made up of countless individual web pages, a crawler attempting to crawl such a site would only ever end up downloading and analysing a single HTML file. To make matters worse, this file would without a doubt contain very little content, as most of the content that makes up an SPA is injected at runtime using JavaScript.</p>

<p>The result of all this is that while SPAs provide users with an enjoyable user experience, web crawlers aren’t adapted to understand how SPAs are built and what kinds of content they contain.</p>

<h2 id="googles_solution">Google’s solution</h2>

<p>Luckily for us, Google has come up with a solution to this problem. The solution consists of a protocol which allows sites to tell crawlers about their dynamic content. <a href="https://developers.google.com/webmasters/ajax-crawling/docs/specification">The full text of the protocol can be found here</a>, but the general idea is as follows. Normally SPAs use hash fragments to denote different pages in an app, like this.</p>

<p><code>http://www.mysite.com/#/contact</code></p>

<p>The protocol states that a hashbang should be used instead of a hash, like so.</p>

<p><code>http://www.mysite.com/#!/contact</code></p>

<p>Now, whenever a crawler sees a link to a page containing a hashbang fragment such as this one, it makes a request to the site passing in the fragment as a query parameter.</p>

<p><code>http://www.mysite.com?_escaped_fragment_=/contact</code></p>

<p>When the server sees such a request come in, it can serve up a static HTML page containing all the content that is dynamically presented in the actual one.</p>

<h2 id="this_can_be_a_pain">This can be a pain</h2>

<p>While this hashbang solution is quite good, it has one annoying consequence for web developers. In order to use this protocol, developers need to maintain static copies of all their dynamic pages which are publicly exposed to web crawlers. Keeping this content up to date as a site evolves is both repetitive and error prone. “There must be a better way!”</p>

<h2 id="there_is">There is!</h2>

<p>This is the problem that I have attempted to solve with Spoon. Spoon is a class library which takes snapshots of your dynamic web pages and serves them up when <code>_escaped_fragment_</code> requests come in.</p>

<h2 id="how_to_use_spoon">How to use Spoon</h2>

<p>Using Spoon is really easy. Get the NuGet package (<code>PM&gt; Install-Package Spoon</code>) and hook the following code into to your site’s <code>Application_Start()</code> method.</p>
<div class='highlight'><pre><code class='csharp'><span class='c1'>// Dictionary mapping escaped fragments to page URLs.</span>
<span class='c1'>// This may be generated from a Sitemap.</span>
<span class='kt'>var</span> <span class='n'>escapedFragmentUrlPairs</span> <span class='p'>=</span> <span class='k'>new</span> <span class='n'>Dictionary</span><span class='p'>&lt;</span><span class='kt'>string</span><span class='p'>,</span> <span class='kt'>string</span><span class='p'>&gt;</span>
<span class='p'>{</span>
    <span class='p'>{</span> <span class='s'>&quot;/home&quot;</span><span class='p'>,</span> <span class='s'>&quot;http://www.example.com/!#/home&quot;</span> <span class='p'>},</span>
    <span class='p'>{</span> <span class='s'>&quot;/about&quot;</span><span class='p'>,</span> <span class='s'>&quot;http://www.example.com/!#/about&quot;</span> <span class='p'>},</span>
    <span class='p'>{</span> <span class='s'>&quot;/contact&quot;</span><span class='p'>,</span> <span class='s'>&quot;http://www.example.com/!#/contact&quot;</span> <span class='p'>},</span>
<span class='p'>};</span>

<span class='kt'>var</span> <span class='n'>snapshotsPath</span> <span class='p'>=</span> <span class='n'>HostingEnvironment</span><span class='p'>.</span><span class='n'>MapPath</span><span class='p'>(</span><span class='s'>&quot;[Path]&quot;</span><span class='p'>);</span>
<span class='kt'>var</span> <span class='n'>snapshotsDirectory</span> <span class='p'>=</span> <span class='k'>new</span> <span class='n'>DirectoryInfo</span><span class='p'>(</span><span class='n'>snapshotsPath</span><span class='p'>);</span>
<span class='k'>foreach</span> <span class='p'>(</span><span class='kt'>var</span> <span class='n'>file</span> <span class='k'>in</span> <span class='n'>snapshotsDirectory</span><span class='p'>.</span><span class='n'>EnumerateFiles</span><span class='p'>())</span>
    <span class='n'>file</span><span class='p'>.</span><span class='n'>Delete</span><span class='p'>();</span>

<span class='n'>SnapshotManager</span>
	<span class='p'>.</span><span class='n'>InitializeAsync</span><span class='p'>(</span><span class='n'>escapedFragmentUrlPairs</span><span class='p'>,</span> <span class='n'>snapshotsPath</span><span class='p'>)</span>
	<span class='p'>.</span><span class='n'>Wait</span><span class='p'>();</span>
</code></pre></div>
<p>In this example, <code>escapedFragmentUrlPairs</code> is a dictionary mapping escaped fragment values to URLs on your site. This essentially serves to tell Spoon that for a given hash fragment you want a snapshot of the corresponding page to be served to the web crawler. If you have a Sitemap defined for your site, this dictionary could easily be auto-generated from it. The other variable in the sample, <code>snapshotsPath</code>, is simply the path to the folder where Spoon will store the snapshots it creates.</p>

<p>To serve up snapshots you’ll need to modify your main action method to handle the <code>_escaped_fragment_</code> parameter.</p>
<div class='highlight'><pre><code class='csharp'><span class='k'>public</span> <span class='k'>async</span> <span class='n'>Task</span><span class='p'>&lt;</span><span class='n'>ActionResult</span><span class='p'>&gt;</span> <span class='n'>Index</span><span class='p'>(</span><span class='kt'>string</span> <span class='n'>_escaped_fragment_</span><span class='p'>)</span>
<span class='p'>{</span>
    <span class='k'>if</span> <span class='p'>(</span><span class='n'>_escaped_fragment_</span> <span class='p'>!=</span> <span class='k'>null</span><span class='p'>)</span>
    <span class='p'>{</span>
        <span class='kt'>string</span> <span class='n'>path</span><span class='p'>;</span>
        <span class='k'>try</span>
        <span class='p'>{</span>
            <span class='n'>path</span> <span class='p'>=</span> <span class='k'>await</span> <span class='n'>SnapshotManager</span>
				<span class='p'>.</span><span class='n'>GetSnapshotUrlAsync</span><span class='p'>(</span><span class='n'>_escaped_fragment_</span><span class='p'>);</span>
        <span class='p'>}</span>
        <span class='k'>catch</span> <span class='p'>(</span><span class='n'>ArgumentException</span><span class='p'>)</span>
        <span class='p'>{</span>
            <span class='c1'>// Failure logic here.</span>
        <span class='p'>}</span>
        <span class='k'>return</span> <span class='nf'>File</span><span class='p'>(</span><span class='n'>path</span><span class='p'>,</span> <span class='s'>&quot;text/html&quot;</span><span class='p'>);</span>
    <span class='p'>}</span>

    <span class='k'>return</span> <span class='nf'>View</span><span class='p'>();</span>
<span class='p'>}</span>
</code></pre></div>
<p>That’s all there is to it. When an <code>_escaped_fragment_</code> is passed to the method, Spoon will look to see if that fragment has been registered. If it has, Spoon will return to you the path to the snapshot file that you can serve with ASP.NET’s <code>File()</code> method. If the fragment hasn’t been registered, an <code>ArgumentException</code> is thrown. It is up to you to catch this exception and do what you please. Be careful! If a snapshot cannot be served for a given page, then web crawlers won’t be able to tell what that page contains and that page will risk not being indexed correctly. At the very least the <code>catch</code> should contain some form of logic to alert you, the developer, that a given <code>_escaped_fragment_</code> has gone unserved in your web app.</p>

<h2 id="the_code">The code</h2>

<p>Spoon is fully open source, licensed under the MIT license. If you’re interested, the source code is available <a href="https://github.com/LeviBotelho/spoon/issues">create an issue on the GitHub page</a>. Good luck, and happy SEO-ing!</p>
                        <br>
                    <span class="entry-tags">
                    <p>
                        <i class="icon-tags"></i>&nbsp;Tagged with <a href="/tags/index.html#asp.net" data-toggle="tooltip" title="Posts tagged with asp.net" rel="tag">asp.net</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#angular.js" data-toggle="tooltip" title="Posts tagged with angular.js" rel="tag">angular.js</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#seo" data-toggle="tooltip" title="Posts tagged with seo" rel="tag">seo</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#google" data-toggle="tooltip" title="Posts tagged with google" rel="tag">google</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#spoon" data-toggle="tooltip" title="Posts tagged with spoon" rel="tag">spoon</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#open source" data-toggle="tooltip" title="Posts tagged with open source" rel="tag">open source</a>
                    </p>
                    </span>
                    </div>
        </div>
                    <footer class="post-footer entry-meta">
                        
                        <div class="post-author text-center">                       
	        <img src="/images/" alt="'s photo" itemprop="image" class="post-avatar img-circle img-responsive"/>    
	    <h4 class="bordered-bottom vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person">By <span itemprop="name" class="fn"><a href="/about" title="About " itemprop="url"></a></span></h4>
	    <p></p>
</div> 
                        
                    </footer>
            </article>
    </div>
</div>

<footer id="footer"  class="blog-background overlay text-center align-middle animated from-top" style="background-image: url(/images/)" >


    <div class="inner">
        <div class="container">

            <ul class="social-icons">
            
            
            
            
            
            
            
            
            
        </ul>
            <p class="copy-text">
                <a href="/about/"></a> &copy; 2014 &bull; All rights reserved.
            </p>
            <p class="copy-text">
                Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <i class="icon-heart"></i> <a href="http://alum.mit.edu/www/hmfaysal/">HMFAYSAL OMEGA</a> theme.
            </p>
            <ul class="menu-items">
            
            <li><a href="/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
            
        </ul>
        </div>
    </div>
    
        <div class="decor-wrapper">
            <svg id="footer-decor" class="decor top" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M0 0 L50 50 L100 0 L0 0" fill="rgba(255,255,255, 1)"></path>

                <path d="M48 48 L50 51 L52 48 L48 48" fill="rgba(255,255,255, 1)"></path>

            </svg>
        </div>
    
</footer>

    
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
    
    <script type="text/javascript" src="/assets/js/script.js"></script>



<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> 
</body>
</html>