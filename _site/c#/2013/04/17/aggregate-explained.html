<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Aggregate Explained &#8211; </title>
<meta name="description" content="">
<meta name="keywords" content="c#, linq">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Aggregate Explained">
<meta property="og:description" content="">
<meta property="og:url" content="/c%23/2013/04/17/aggregate-explained.html">
<meta property="og:site_name" content="">
<meta property="og:image" content="/images/">





<link rel="canonical" href="/c%23/2013/04/17/aggregate-explained.html">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title=" Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="stylesheet" type="text/css" href="/assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css" />






<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  

<header id="masthead" class="blog-background overlay align-center align-middle animated from-bottom"  style="background-image: url(/images/)" itemscope itemtype="http://schema.org/Organization">


    <div class="inner">
        <div class="container">
            <a class="brand" href="/" role="banner" itemprop="url">

                

            <h1 class="blog-title light" itemprop="name">
                
            </h1>
                
            </a>
        </div>
    </div>
    
    
    <div class="decor-wrapper">
        <svg id="header-decor" class="decor bottom" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">
            <path d="M0 99.9 L50 49.9 L100 99.9 L0 99.9" fill="rgba(255,255,255, 1)"></path>

            <path d="M48 52 L50 49 L52 52 L48 52" fill="rgba(255,255,255, 1)"></path>

        </svg>
    </div>
    
</header>
<div id="main" class="content" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
    <div class="container">
        <div class="row">
            <article class="post col-md-8 col-md-offset-2 hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
            
            
            
                
            
             
             
                    <header class="post-header entry-header">
                        
                        <h1 class="post-title text-center hyper lighter bordered-bottom entry-title" itemprop="headline">Aggregate Explained</h1>
                        
                        <div class="post-info text-center small">
                            <span class="entry-date date published"><time datetime="2013-04-17T00:00:00+02:00" class="post-time" itemprop="datePublished">17 Apr 2013</time><span>
                            in <span class="post-tags"><a href="/categories/index.html#c#" data-toggle="tooltip" title="Other posts from the C# category" rel="tag">C#</a></span>
                        </div>
                    </header>
                    <div class="post-body bordered-bottom" itemprop="description">
                        
                        <p>For my money, LINQ is in itself a reason to program in C#. It saves time, reduces the amount of code needed to perform a given task, and is simple to debug. A function I really like is <strong>Aggregate</strong>. That said, I admit that it took a while for me to adopt it into my coding repertoire because its name doesn’t do a very good job at describing what it does or how to use it.</p>

<h2 id="what_does_it_do">What does it do?</h2>

<p>Aggregate takes a collection of small objects and combines them one by one into a single large object. It can take an optional “seed” value to which all the objects are added as well as a “selector” function which applies a final transformation on the combined object.</p>

<h2 id="how_is_it_used">How is it used?</h2>

<p>The definition of Aggregate in its simplest form looks like this:</p>
<div class='highlight'><pre><code class='csharp'><span class='n'>collection</span><span class='p'>.</span><span class='n'>Aggregate</span><span class='p'>(</span><span class='n'>Func</span><span class='p'>&lt;</span><span class='n'>TSource</span><span class='p'>,</span> <span class='n'>TSource</span><span class='p'>,</span> <span class='n'>TSource</span><span class='p'>&gt;)</span>
</code></pre></div>
<p>As you can see, the Func passed to Aggregate takes two variables. The first represents the “accumulated” value and the second represents the given element in the collection. A simple way to demonstrate this is by using it to sum a collection of numbers.</p>
<div class='highlight'><pre><code class='csharp'><span class='kt'>var</span> <span class='n'>numbers</span> <span class='p'>=</span> <span class='k'>new</span> <span class='kt'>int</span><span class='p'>[]</span> <span class='p'>{</span> <span class='m'>1</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>,</span> <span class='m'>4</span> <span class='p'>};</span>
<span class='kt'>var</span> <span class='n'>sum</span> <span class='p'>=</span> <span class='n'>numbers</span><span class='p'>.</span><span class='n'>Aggregate</span><span class='p'>((</span><span class='n'>accumulated</span><span class='p'>,</span> <span class='n'>number</span><span class='p'>)</span> <span class='p'>=&gt;</span> <span class='n'>accumulated</span> <span class='p'>+</span>
<span class='n'>number</span><span class='p'>);</span>
<span class='n'>Console</span><span class='p'>.</span><span class='n'>WriteLine</span><span class='p'>(</span><span class='n'>sum</span><span class='p'>);</span> <span class='c1'>// Returns 10</span>
</code></pre></div>
<p>The aggregation starts with an empty result (which in this case is <em>default(int)</em>, or 0) and adds the first number of the collection to it. The result then becomes the accumulated value to which the second number is added in the following iteration. This continues until there are no more elements.</p>

<p>A seed value can optionally be passed to Aggregate to give it an initial value to which the first element in the collection is added. For example:</p>
<div class='highlight'><pre><code class='csharp'><span class='kt'>var</span> <span class='n'>numbers</span> <span class='p'>=</span> <span class='k'>new</span> <span class='kt'>int</span><span class='p'>[]</span> <span class='p'>{</span> <span class='m'>1</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>,</span> <span class='m'>4</span> <span class='p'>};</span>
<span class='kt'>var</span> <span class='n'>sum</span> <span class='p'>=</span> <span class='n'>numbers</span><span class='p'>.</span><span class='n'>Aggregate</span><span class='p'>(</span><span class='m'>10</span><span class='p'>,</span> <span class='p'>(</span><span class='n'>accumulated</span><span class='p'>,</span> <span class='n'>number</span><span class='p'>)</span> <span class='p'>=&gt;</span> <span class='n'>accumulated</span> <span class='p'>+</span> <span class='n'>number</span><span class='p'>);</span>
<span class='n'>Console</span><span class='p'>.</span><span class='n'>WriteLine</span><span class='p'>(</span><span class='n'>sum</span><span class='p'>);</span> <span class='c1'>// Returns 20</span>
</code></pre></div>
<p>Finally, a “selector” function can be passed to Aggregate which is executed on the final result of the aggregation before it is returned. To demonstrate, if I wanted to return the string representation of the above function, I could do this as follows:</p>
<div class='highlight'><pre><code class='csharp'><span class='kt'>var</span> <span class='n'>numbers</span> <span class='p'>=</span> <span class='k'>new</span> <span class='kt'>int</span><span class='p'>[]</span> <span class='p'>{</span> <span class='m'>1</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>,</span> <span class='m'>4</span> <span class='p'>};</span>
<span class='kt'>var</span> <span class='n'>sum</span> <span class='p'>=</span> <span class='n'>numbers</span><span class='p'>.</span><span class='n'>Aggregate</span><span class='p'>(</span><span class='m'>10</span><span class='p'>,</span> <span class='p'>(</span><span class='n'>accumulated</span><span class='p'>,</span> <span class='n'>number</span><span class='p'>)</span> <span class='p'>=&gt;</span> <span class='n'>accumulated</span> <span class='p'>+</span> <span class='n'>number</span><span class='p'>,</span> <span class='n'>x</span> <span class='p'>=&gt;</span> <span class='n'>x</span><span class='p'>.</span><span class='n'>ToString</span><span class='p'>());</span>
<span class='n'>Console</span><span class='p'>.</span><span class='n'>WriteLine</span><span class='p'>(</span><span class='n'>sum</span><span class='p'>);</span> <span class='c1'>// Returns &quot;20&quot;</span>
</code></pre></div>
<h2 id="a_more_complex_implementation">A more complex implementation</h2>

<p>Let’s imagine that we are given a collection of integers and that we want to return a string containing all of them as a comma-separated list. We also want to use a StringBuilder to do the actual combining. Here is how it can be done:</p>
<div class='highlight'><pre><code class='csharp'><span class='kt'>var</span> <span class='n'>numbers</span> <span class='p'>=</span> <span class='k'>new</span> <span class='kt'>int</span><span class='p'>[]</span> <span class='p'>{</span> <span class='m'>1</span><span class='p'>,</span> <span class='m'>2</span><span class='p'>,</span> <span class='m'>3</span><span class='p'>,</span> <span class='m'>4</span> <span class='p'>};</span>
<span class='kt'>var</span> <span class='n'>sum</span> <span class='p'>=</span> <span class='n'>numbers</span><span class='p'>.</span><span class='n'>Aggregate</span><span class='p'>(</span>
    <span class='k'>new</span> <span class='nf'>StringBuilder</span><span class='p'>(),</span>
    <span class='p'>(</span><span class='n'>x</span><span class='p'>,</span> <span class='n'>y</span><span class='p'>)</span> <span class='p'>=&gt;</span>
    <span class='p'>{</span>
        <span class='n'>x</span><span class='p'>.</span><span class='n'>Append</span><span class='p'>(</span><span class='n'>y</span><span class='p'>);</span>
        <span class='k'>return</span> <span class='n'>x</span><span class='p'>.</span><span class='n'>Append</span><span class='p'>(</span><span class='s'>&quot;, &quot;</span><span class='p'>);</span>
    <span class='p'>},</span>
    <span class='n'>x</span> <span class='p'>=&gt;</span>
    <span class='p'>{</span>
        <span class='kt'>var</span> <span class='n'>result</span> <span class='p'>=</span> <span class='n'>x</span><span class='p'>.</span><span class='n'>ToString</span><span class='p'>();</span>
        <span class='k'>return</span> <span class='n'>result</span><span class='p'>.</span><span class='n'>Remove</span><span class='p'>(</span><span class='n'>result</span><span class='p'>.</span><span class='n'>LastIndexOf</span><span class='p'>(</span><span class='s'>&quot;,&quot;</span><span class='p'>));</span>
    <span class='p'>});</span>
<span class='n'>Console</span><span class='p'>.</span><span class='n'>WriteLine</span><span class='p'>(</span><span class='n'>sum</span><span class='p'>);</span> <span class='c1'>// returns &quot;1, 2, 3, 4&quot;</span>
</code></pre></div>
<p>The first argument to the function specifies a new StringBuilder object as the seed value. The second argument which is executed for each number in our collection appends the number to the StringBuilder as well as a comma and a space. Note that we need to return the StringBuilder each time so that it can be used in the following iteration. The final argument removes the last comma and space from the resulting string and returns the result.</p>

<h2 id="a_small_disclaimer">A small disclaimer</h2>

<p>The above example is useful for understanding how Aggregate works. There is however, a far more concise way to achieve the same result:</p>
<div class='highlight'><pre><code class='csharp'><span class='n'>sum</span> <span class='p'>=</span> <span class='kt'>string</span><span class='p'>.</span><span class='n'>Join</span><span class='p'>(</span><span class='s'>&quot;, &quot;</span><span class='p'>,</span> <span class='n'>numbers</span><span class='p'>);</span>
</code></pre></div>
                        <br>
                    <span class="entry-tags">
                    <p>
                        <i class="icon-tags"></i>&nbsp;Tagged with <a href="/tags/index.html#c#" data-toggle="tooltip" title="Posts tagged with c#" rel="tag">c#</a>&nbsp;&bull;&nbsp;<a href="/tags/index.html#linq" data-toggle="tooltip" title="Posts tagged with linq" rel="tag">linq</a>
                    </p>
                    </span>
                    </div>
        </div>
                    <footer class="post-footer entry-meta">
                        
                        <div class="post-author text-center">                       
	        <img src="/images/" alt="'s photo" itemprop="image" class="post-avatar img-circle img-responsive"/>    
	    <h4 class="bordered-bottom vcard author" itemprop="author" itemscope itemtype="http://schema.org/Person">By <span itemprop="name" class="fn"><a href="/about" title="About " itemprop="url"></a></span></h4>
	    <p></p>
</div> 
                        
                    </footer>
            </article>
    </div>
</div>

<footer id="footer"  class="blog-background overlay text-center align-middle animated from-top" style="background-image: url(/images/)" >


    <div class="inner">
        <div class="container">

            <ul class="social-icons">
            
            
            
            
            
            
            
            
            
        </ul>
            <p class="copy-text">
                <a href="/about/"></a> &copy; 2014 &bull; All rights reserved.
            </p>
            <p class="copy-text">
                Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <i class="icon-heart"></i> <a href="http://alum.mit.edu/www/hmfaysal/">HMFAYSAL OMEGA</a> theme.
            </p>
            <ul class="menu-items">
            
            <li><a href="/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
            
        </ul>
        </div>
    </div>
    
        <div class="decor-wrapper">
            <svg id="footer-decor" class="decor top" xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path d="M0 0 L50 50 L100 0 L0 0" fill="rgba(255,255,255, 1)"></path>

                <path d="M48 48 L50 51 L52 48 L48 48" fill="rgba(255,255,255, 1)"></path>

            </svg>
        </div>
    
</footer>

    
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
    
    <script type="text/javascript" src="/assets/js/script.js"></script>



<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = ''; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> 
</body>
</html>